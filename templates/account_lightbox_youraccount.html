{% load socialaccount %}

<a class="lightbox-close"></a>
<h2>Your Account</h2>

<div id="account-tabs" class="nootabs {useCookies:false, useHash:false}">
    <ul class="nootabs-menus">
        <li><a href="">Alerts</a></li>
        <li><a href="">Favorites</a></li>
        <li class="last-menu"><a href="">Connected Accounts</a></li>
    </ul>

    <!-- Alerts tab -->
    <div id="alerts-tab" class="nootabs-tab">
       {% if alerts %}
		<p class="first">Click <span class="icon-cancel icomoon-icon"></span> to unsubscribe from alert.</p>
		<ul class="topicList">
			{% for alert in alerts %}
			<li><a href="javascript:Tags.selectTag({{ alert.node.id }});" onclick="_gaq.push(['_trackEvent', 'Tags', 'Click', '{{ alert.node.name}}']);" rel="nofollow">{{ alert.node.name }}</a> <span class="icon-cancel unsubscribe icomoon-icon" data-nodeid="{{ alert.node.id }}"></span></li>
			{% endfor %}
		</ul>
		{% else %}
		You are not subscribed to any alerts. Click the <span class="icon-alert icomoon-icon"></span> icon to subscribe to alerts.
		{% endif %}
    </div>
    
    <!-- Favorites tab -->
    <div id="favorites-tab" class="nootabs-tab">
		{% if favorites %}
		<p class="first">Click <span class="icon-cancel icomoon-icon"></span> to remove from your favorites.</p>
		<ul class="topicList">
			<strong>Topics</strong><br/>
			{% for topic in favorites %}
			<li><a href="javascript:Tags.selectTag({{ topic.id }});" onclick="_gaq.push(['_trackEvent', 'Tags', 'Click', '{{ topic.name}}']);" rel="nofollow">{{ topic.name }}</a> <span class="icon-cancel unfavorite icomoon-icon" data-nodeid="{{ topic.id }}"></span>
			{% endfor %}
		</ul>
		{% else %}
		You have not added any topics to your favorites. Click the <span class="icon-star -wholeicomoon-icon"></span> icon to add a topic to your favorites.
		{% endif %}
    </div>

    <!-- Connected Accounts tab -->
    <div id="connectacct-tab" class="nootabs-tab">
        You can remove your connected social media accounts:
        {% get_social_accounts user as accounts %}
        {% if accounts %}
            <ul>
            {% for key, values in accounts.items %}
                <li>{{ key }} accounts:
                    <ul>
                    {% for account in values %}
                        <li>{{ account.user.username }}</li>
                    {% endfor %}
                    </ul>
                </li>
            {% endfor %}
            </ul>
        {% else %}
            There are no connected accounts (impossible situation)
        {% endif %}

        You can connect new social media accounts:
        <div>
            <a class="btn account" href="{% provider_login_url "google" process="connect" %}"><span class="icon-google icomoon-icon"></span>Sign In or Join with Google</a>
    {#	    <a class="btn account" href="{% provider_login_url "facebook" process="connect" %}"><span class="icon-facebook icomoon-icon"></span>Sign In or Join with Facebook</a>#}
            <a class="btn account" href="{% provider_login_url "linkedin_oauth2" process="connect" %}"><span class="icon-linkedin icomoon-icon"></span>Sign In or Join with LinkedIn</a>
        </div>

    </div>

</div>
<div class="clearfix"></div>

<script type="text/javascript">
    $(function() {
        var action;
        var nodeid;
        $('.unsubscribe').click(function(){
        	nodeid = $(this).data('nodeid');
        	$(this).parent().remove();
            $.post('/ajax/notification/request',
                {
                    email: '{{ user.email }}',
                    nodeid: nodeid,
                    action: 'disable'
                },
                function(){
                    return false;
                }
            );
        });
    });
    $(function() {
    	var action;
        var nodeid;
        $('.unfavorite').click(function(){
            nodeid = $(this).data('nodeid');
            $(this).parent().remove();
            $.post('/ajax/favorites/request',
                {
                    nodeid: nodeid,
                    action: 'disable'
                },
                function(){
                    return false;
                }
            );
        });
    });
</script>
