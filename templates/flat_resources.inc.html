{% load humanize filters smartif %}
{% comment %}
Include file used by both print_resource.html and tag_landing.html
{% endcomment %}
<div id="tag_page">

        <div id="tag_header">
            {{ related_items_count|intcomma }} Related resources for <span>{{ tag.name }}</span>
        </div>
        <table id="tag_middle"><tbody>
            <tr>
                {% if toc %}
                <td>
                    <div id="tag_contents">
                        <span>Contents</span>
                        <ol>
                            {% if sectors %}<li><a href="#sectors">Sectors</a></li>{% endif %}
                            {% if societies %}<li><a href="#societies">Societies</a></li>{% endif %}
                            {% if related_tags %}<li><a href="#related_tags">Related Tags</a></li>{% endif %}
                            {% if conferences %}<li><a href="#conferences">Conferences</a></li>{% endif %}
                            {% if periodicals %}<li><a href="#periodicals">Periodicals</a></li>{% endif %}
                            {% if standards %}<li><a href="#standards">Standards</a></li>{% endif %}
                            {% if xplore_results %}<li><a href="#xplore">Xplore Articles</a></li>{% endif %}
                        </ol>
                    </div>
                </td>
                {% endif %}
                <td>
		        {% if create_links %}
		            <div id="tag_technav" onclick="location.href='/textui/?autoload={{ tag.id }}';">
		                <span>View them inside of<br/>Technology Navigator</span>
                    </div>
                {% endif %}
                </td>
            </tr>
        </tbody></table>
        {% if sectors %}
        <div id="tag-sectors">
            <h3><a href="" name="sectors"></a>Sectors</h3><a href="#top" class="topLink">Back to Top</a>
            <ul>
                {% for parent in sectors %}
                    <li>
                        {% if create_links %}
                            <a href="/tag/{{ parent.id }}/{{ parent.name|slugify }}">{{ parent.name }}</a>
                        {% else %}
                            {{ parent.name }}
                        {% endif %}
                    </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
                
        {% if societies %}
        <div id="tag-societies">
            <h3><a name="societies"></a>Societies</h3><a href="#top" class="topLink">Back to Top</a>
            <ul>
                {% for society in societies %}
                    <li>
                        {% if create_links %}
                            <a href="{{ society.url }}">{{ society.name }}</a>
                        {% else %}
                            {{ society.name }}
                        {% endif %}
                    </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
            
        {% if related_tags %}
        <div id="tag-related-tags">
            <h3><a name="related_tags"></a>Related Tags</h3><a href="#top" class="topLink">Back to Top</a>
            <ul>
                {% for related_tag in related_tags %}
                    <li>
                        {% if create_links %}
                            <a href="/tag/{{ related_tag.id }}/{{ related_tag.name|slugify }}">{{ related_tag.name }}</a>
                        {% else %}
                            {{ related_tag.name }}
                        {% endif %}
                    </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
            
        {% if conferences %}
        <div id="tag-conferences">
            <h3><a name="conferences"></a>Conferences</h3><a href="#top" class="topLink">Back to Top</a>
            <ul>
        {% if conferences|length %}
            {% for resource in conferences %}
                {# grouped conference displayed on the tag landing page #}
                <li>
                {% if resource.url and resource.url_status != "bad" %}<a href="{{ resource.url }}" target="_blank">{% endif %}
                    <span>{{resource.name}}</span>
                    {% if resource.url and resource.url_status != "bad" %}</a>{% endif %}
                    <p>{{resource.description}}</p>
                    {% if resource.is_current_conference and resource.other_conferences|length %}
                        <ul class="conference-series">
                            {% for other_conference in resource.other_conferences %}
                                <li>
                                {% if other_conference.url and other_conference.url_status != "bad" %}
                                    <a href="{{ other_conference.url }}" target="_blank">
                                {% endif %}
                                    <span>{{other_conference.name}}</span>
                                {% if other_conference.url and other_conference.url_status != "bad" %}
                                    </a>
                                {% endif %}
                                <p class="{% cycle 'desc_odd' 'desc_even' %} ">{{other_conference.description}}</p>
                                </li>
                            {% endfor %}
                        </ul>
                        
                    {% endif %}
                </li>
            {% endfor %}
        {% else %}
            <p class="no-resources">No conferences are currently tagged "{{ tag.name }}"</p>
        {% endif %}
            {% for conference in conferences.all %}
                {# ungrouped conference displayed on the print resource page #}
                <li>
                    <p class="title">
                    {% if create_links %}
                        <a href="{{ conference.url }}">{{ conference.name }}</a>
                    {% else %}
                        {{ conference.name }}
                    {% endif %}
                    </p>
                    <p class="description">
                        {{ conference.description|truncatewords:60 }}
                    </p>
                </li>
            {% endfor %}
            </ul>
        </div>
        {% endif %}
            
        {% if periodicals %}
        <div id="tag-periodicals">
            <h3><a name="periodicals"></a>Periodicals</h3><a href="#top" class="topLink">Back to Top</a>
            <ul class="tag_list">
                {% for periodical in periodicals.all %}
                    <li>
                        <p class="title">
                        {% if create_links %}
                            <a href="{{ periodical.url }}">{{ periodical.name }}</a>
                        {% else %}
                            {{ periodical.name }}
                        {% endif %}
                        </p>
                        <p class="description">
                            {{ periodical.description|truncatewords:60 }}
                        </p>
                    </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
            
        {% if standards %}
        <div id="tag-standards">
            <h3><a name="standards"></a>Standards</h3><a href="#top" class="topLink">Back to Top</a>
            <ul class="tag_list">
                {% for standard in standards.all %}
                    <li>
                        <p class="title">
                        {% if create_links %}
                            <a href="{{ standard.url }}">{{ standard.name }}</a>
                        {% else %}
                            {{ standard.name }}
                        {% endif %}
                        </p>
                        <p class="description">
                            {{ standard.description|truncatewords:60 }}
                        </p>
                    </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
            
        {% if xplore_results %}
        <div id="tag-xplore">
            <h3><a name="xplore"></a>Xplore Articles</h3><a href="#top" class="topLink">Back to Top</a>
            <ul class="tag_list">
                {% for xplore_result in xplore_results %}
                    <li>
                        <p class="title">
                        {% if create_links %}
                            <a href="{{ xplore_result.url }}">{{ xplore_result.name }}</a>
                        {% else %}
                            {{ xplore_result.name }}
                        {% endif %}
                        </p>
                        <p class="pub-info">
                            {{ xplore_result.authors }} {{ xplore_result.pub_title }},  {{ xplore_result.pub_year }}
                        </p>
                        <p class="description">
                            {{ xplore_result.description|truncatewords:60 }}
                        </p>
                    </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
</div>