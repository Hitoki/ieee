<script type="text/javascript">    
    $(function() {
        var action;
        $('.subscribe').click(function(){
            if ($(this).hasClass('enabled')) {
                action = 'disable';
                $('.alertOff').hide();
                $('.alertOn').show();
                $('.tag-icons').children('.favorite-topic').removeClass('icon-star-whole-alert').addClass('icon-star-whole');
            } else {
                action = 'enable';
                $('.alertOn').hide();
                $('.alertOff').show();
                $('.tag-icons').children('.favorite-topic').removeClass('icon-star-whole').addClass('icon-star-whole-alert');
            }
            $.post('/ajax/notification/request',
                {
                    email: '{{ user.email }}',
                    nodeid: {{ tag.id }},
                    action: action
                },
                function(){
                    return false;
                }
            );
        });
    });

    $(function() {
        var action;
        var nodeid;
        $('.favorite-topic').click(function(){
            $('.qtip').qtip('hide');
            nodeid = $(this).data('nodeid');
            if ($(this).hasClass('enabled')) {
                action = 'disable';
                $(this).parent().removeClass('is-favorite');
                $(this).removeClass('icon-star-whole enabled').addClass('icon-star');
                $(this).siblings('.alertMenu').children('.alertOn').hide();
                $(this).siblings('.alertMenu').children('.alertOff').show();
            } else {
                action = 'enable';
                $(this).parent().addClass('is-favorite');
                $(this).removeClass('icon-star').addClass('icon-star-whole enabled');
                $(this).siblings('.alertMenu').children('.alertOff').hide();
                $(this).siblings('.alertMenu').children('.alertOn').show();
            }
            $.post('/ajax/favorite-topic/request',
                {
                    nodeid: nodeid,
                    action: action
                },
                function(){
                    return false;
                }
            );
        }).qtip();
    });

    $(function() {
        $('.no-enable-alert').click(function() {
            $(this).parent().parent().hide();
        });
    });
</script>